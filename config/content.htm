<h1>About</h1>
<p>網站: <a href="https://mdecd2023.github.io/football-apj1">https://mdecd2023.github.io/football-apj1</a><span><span> </span></span></p>
<p><span>倉儲:<span> </span></span><a href="https://github.com/mdecd2023/football-apj1">https://github.com/mdecd2023/football-apj1</a></p>
<p><span>討論區: </span><a href="https://github.com/mdecd2023/football-apj1/discussions">https://github.com/mdecd2023/football-apj1/discussions</a></p>
<h1>足球場景</h1>
<p>bubbleRob1 與 bubbleRob2 分別透過 19997 與 19998 埠號交由雙方的 Python remoteAPI 進行控制</p>
<p>場景串流埠號: 23020</p>
<p>假設: 19997 與 bubbleRob1 的控制在一台 Windows 10 電腦上, 而 19998 則交由另外一台電腦控制.</p>
<h1>評分</h1>
<p><a href="https://gist.githubusercontent.com/mdecycu/92a2f2d8389aeeca986ecb9f7a901180/raw/a9fcd1d1f33d892c8a1f30102262a3269475741f/2a_w6-2_python_remote_api_result.txt">2a w6-2 Python remoteAPI 連線查驗結果.txt</a></p>
<p><a href="https://mde.tw/studlist/2023spring/2a.txt">2a 學號與 Githbu 帳號對應名單</a></p>
<p>還需要設法取得各組組員名單, 然後再換成學號</p>
<p>請各組在 pj1 分組網頁中, 以 w6 (H2) 作為頁面標題, 直接在頁面中, 列出完成連線的分組與未完成連線的分組組員學號. </p>
<p>預計採用 Brython 讀取上面兩個連結資料後, 再逐一利用迴圈進行比對</p>
<!-- 建立 Brython 環境 -->
<p id="brython_div"></p>
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
<script>
window.onload=function(){
brython({debug:1, pythonpath:['/static/']});
}
</script>
<p id="output"></p>
<script type="text/python">
# 從 browser 模組導入 html 與 document
# html 用於建立 html 物件, 而 document 則可對應到網頁元件
from browser import html, document
import re
# api 練習傳送結果的 gist url
api_result_url = "https://gist.githubusercontent.com/mdecycu/92a2f2d8389aeeca986ecb9f7a901180/raw/a9fcd1d1f33d892c8a1f30102262a3269475741f/2a_w6-2_python_remote_api_result.txt"
# 從 studlist 倉儲取得的學號與帳號對應連結
stud_github_url = "https://mde.tw/studlist/2023spring/2a.txt"
api_result = open(api_result_url).read().split("\n")
output = document["output"]
group = []
for i in api_result:
    try:
        if "虛擬世界" not in i:
            num = re.findall('\d+', i )
            if num[0] != "":
                #output <= str(num[0])
                #output <= html.BR()
                group.append(int(num[0]))
    except:
        pass
    
stud_github = open(stud_github_url).read().split("\n")
for i in stud_github:
    output <= i
    output <= html.BR()
output <= "完成 remote API 連線的 2a 組別"
output <= html.BR()
output <= str(sorted(list(set(group))))
</script>
<h1>pj1</h1>
<h2>ag2</h2>
<p>2a-pj1ag2組員:41023146洪偉陞、41023148夏進源</p>
<p>pj1倉儲:<a href="https://github.com/mdecd2023/2a-pj1ag2">https://github.com/mdecd2023/2a-pj1ag2</a></p>
<p>pj1網頁:<a href="https://mdecd2023.github.io/2a-pj1ag2/content/index.html">https://mdecd2023.github.io/2a-pj1ag2/content/index.html</a></p>
<p>bubbleRob足球遊戲</p>
<p>1.先繪製球框(<a href="/downloads/ag2_downloads/ball frame.7z">ball frame.7z</a>)</p>
<p><img alt="" height="300" src="/downloads/ag2_downloads/2023-03-27.png" width="500"/></p>
<p>2.使用鍵盤控制<a href="/downloads/ag2_downloads/bubbleRob_lua.ttt">bubbleRob</a></p>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">function sysCall_init()  
    right_wheel= sim.getObjectHandle('joint1') 
    left_wheel= sim.getObjectHandle('joint2') 
    right_velocity=0 
    left_velocity=0
    speed=5
    sim.setJointTargetVelocity(right_wheel,0)
    sim.setJointTargetVelocity(left_wheel,0)
 
end
  
function sysCall_actuation()  
    message,auxiliaryData=sim.getSimulatorMessage() 
    while message~=-1 do
        if (message==sim.message_keypress) then
            
            if (auxiliaryData[1]==32) then

                right_velocity=0 
                left_velocity=0 
                sim.setJointMaxForce(right_wheel, 0) 
                sim.setJointMaxForce(left_wheel, 0) 
                break
            else
                sim.setJointMaxForce(right_wheel, 10) 
                sim.setJointMaxForce(left_wheel, 10)
            
            
                if (auxiliaryData[1]==2007) then -- up key
                    
                    sim.setJointTargetVelocity(right_wheel,speed)
                    sim.setJointTargetVelocity(left_wheel,speed)
                end
                if (auxiliaryData[1]==2008) then -- down key
                    
                    sim.setJointTargetVelocity(right_wheel,-speed/2)
                    sim.setJointTargetVelocity(left_wheel,-speed/2)
                    
                end
                if (auxiliaryData[1]==2009) then -- left key
                    sim.setJointTargetVelocity(right_wheel,speed)
                    sim.setJointTargetVelocity(left_wheel,speed/2)
                   
                end
                if (auxiliaryData[1]==2010) then -- right key
                    sim.setJointTargetVelocity(right_wheel,speed/2)
                    sim.setJointTargetVelocity(left_wheel,speed)
                    
                end

            end
        end
        message,auxiliaryData=sim.getSimulatorMessage()
    end
end</pre>
<p></p>
<p>3.加入球框感測器和記分板(<a href="/downloads/ag2_downloads/newbubbleRob2.ttt">newbubbleRob.ttt</a>)</p>
<p><img alt="" height="300" src="/downloads/ag2_downloads/scoreboard.png" width="500"/></p>
<p>感測器lua腳本</p>
<pre class="brush:lua;auto-links:false;toolbar:false" contenteditable="false">function sysCall_init()
    score1 = 0
    
    sensor = sim.getObject('./sensor')
    xml = [[
        &lt;ui title="Scoreboard" closeable="false" resizable="false" style="plastique"&gt;
        &lt;label text="Score:" style="* {background-color: #808080; color: #000000; font-size: 40px; font-weight: bold; padding: 5px; border-radius: 5px; }" id="10"/&gt;
        &lt;label text="0" style="* {background-color: #FFF; color: #000000; font-size: 40px; font-weight: bold; padding: 5px; border-radius: 5px;}" id="30"/&gt;
     
        &lt;/ui&gt;
    ]]
    ui = simUI.create(xml)
    simUI.setPosition(ui, 0,0, true)
    bubbleRob = sim.getObject('/bubbleRob')
    ball = sim.getObject('/ball')
    bubbleRob2 = sim.getObject('/bubbleRob2')
    initialPosition = sim.getObjectPosition(bubbleRob, -1)
    initialOrientation = sim.getObjectOrientation(bubbleRob, -1)
    initialPosition2 = sim.getObjectPosition(bubbleRob2, -1)
    initialOrientation2 = sim.getObjectOrientation(bubbleRob2, -1)
    initialballPosition = sim.getObjectPosition(ball, -1)
    initialballOrientation = sim.getObjectOrientation(ball, -1)

end


function sysCall_actuation()
    --simUI.setLabelText(ui, 30, tostring(sim.getFloatSignal("myVariable")))
    result=sim.readProximitySensor(sensor)
    if(score1&lt;5)then
        if(result&gt;0)then
            score2 = score1+1
            simUI.setLabelText(ui, 30, tostring(score2))

            sim.setObjectPosition(bubbleRob, -1, initialPosition)
            sim.setObjectOrientation(bubbleRob, -1, initialOrientation)
            sim.setObjectPosition(bubbleRob2, -1, initialPosition2)
            sim.setObjectOrientation(bubbleRob2, -1, initialOrientation2)
            sim.setObjectPosition(ball, -1, initialballPosition)
            sim.setObjectOrientation(ball, -1, initialballOrientation)
            score1=score2
        end
    else
        sim.pauseSimulation()
    end
end</pre>
<p></p>
<p>4.改成用遠端api操控bubbleRob前後左右移動(<a href="/downloads/ag2_downloads/bubbleRob.7z">bubbleRob.7z</a>)</p>